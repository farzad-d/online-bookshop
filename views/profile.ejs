<%- include('partials/header') %>

<div class="container login-register-container mt-5">
  <h2 class="mb-5">Profile</h2>

  <% if (typeof success_msg !== 'undefined' && success_msg.length > 0) { %>
  <div class="alert alert-success"><%= success_msg %></div>
  <% } %> <% if (typeof error_msg !== 'undefined' && error_msg.length > 0) { %>
  <div class="alert alert-danger"><%= error_msg %></div>
  <% } %>

  <form id="profileForm" action="/profile" method="POST">
    <div class="form-group">
      <label for="fullname">Full Name</label>
      <input
        type="text"
        class="form-control"
        id="fullname"
        name="fullname"
        value="<%= user.fullname %>"
        disabled
      />
    </div>
    <div class="form-group">
      <label for="email">Email</label>
      <input
        type="email"
        class="form-control"
        id="email"
        name="email"
        value="<%= user.email %>"
        disabled
      />
    </div>
    <div class="form-group">
      <label for="phone">Phone</label>
      <input
        type="text"
        class="form-control"
        id="phone"
        name="phone"
        value="<%= user.phone %>"
        disabled
      />
    </div>
    <div class="form-group">
      <label for="address">Address</label>
      <input
        type="text"
        class="form-control"
        id="address"
        name="address"
        value="<%= user.address %>"
        disabled
      />
    </div>
    <div class="form-group">
      <label for="postalCode">Postal Code</label>
      <input
        type="text"
        class="form-control"
        id="postalCode"
        name="postalCode"
        value="<%= user.postalCode %>"
        disabled
      />
    </div>
    <button
      type="button"
      id="editProfileBtn"
      class="btn btn-light profile-form-btn"
    >
      Edit
    </button>
    <button
      type="submit"
      id="saveProfileBtn"
      class="btn btn-primary profile-form-btn"
      style="display: none"
    >
      Save
    </button>
  </form>

  <hr class="profile-hr mt-5" />

  <h2 class="mb-5 mt-4">Change Password</h2>
  <form action="/profile/password" method="POST">
    <div class="form-group">
      <label for="currentPassword">Current Password</label>
      <input
        type="password"
        class="form-control"
        id="currentPassword"
        name="currentPassword"
        required
      />
    </div>
    <div class="form-group">
      <label for="newPassword">New Password</label>
      <input
        type="password"
        class="form-control"
        id="newPassword"
        name="newPassword"
        required
      />
    </div>
    <div class="form-group">
      <label for="confirmNewPassword">Confirm New Password</label>
      <input
        type="password"
        class="form-control"
        id="confirmNewPassword"
        name="confirmNewPassword"
        required
      />
    </div>
    <button type="submit" class="btn btn-light profile-form-btn">
      Change Password
    </button>
  </form>
</div>

<script>
  document
    .getElementById("editProfileBtn")
    .addEventListener("click", function () {
      const fields = document.querySelectorAll("#profileForm input");
      fields.forEach((field) => (field.disabled = false));
      document.getElementById("editProfileBtn").style.display = "none";
      document.getElementById("saveProfileBtn").style.display = "block";
    });
</script>

<%- include('partials/footer') %>
